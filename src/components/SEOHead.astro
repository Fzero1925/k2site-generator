---
import type { SEOData } from '@/lib/seo';

interface Props {
  seo: SEOData;
  jsonLD?: string;
}

const { seo, jsonLD } = Astro.props;
const config = (await import('@/lib/config')).getConfig();
---

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="generator" content={Astro.generator} />

<!-- Primary Meta Tags -->
<title>{seo.title}</title>
<meta name="title" content={seo.title} />
<meta name="description" content={seo.description} />
{seo.canonical && <link rel="canonical" href={seo.canonical} />}

<!-- Theme Color -->
<meta name="theme-color" content={config.site.themeColor} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={seo.ogType} />
<meta property="og:url" content={seo.canonical || config.site.domain} />
<meta property="og:title" content={seo.ogTitle || seo.title} />
<meta property="og:description" content={seo.ogDescription || seo.description} />
{seo.ogImage && <meta property="og:image" content={seo.ogImage} />}
<meta property="og:site_name" content={config.site.name} />
<meta property="og:locale" content={config.site.language} />

<!-- Twitter -->
<meta property="twitter:card" content={seo.twitterCard} />
<meta property="twitter:url" content={seo.canonical || config.site.domain} />
<meta property="twitter:title" content={seo.ogTitle || seo.title} />
<meta property="twitter:description" content={seo.ogDescription || seo.description} />
{seo.ogImage && <meta property="twitter:image" content={seo.ogImage} />}
{config.seo.twitterHandle && <meta property="twitter:site" content={config.seo.twitterHandle} />}

<!-- Article specific meta tags -->
{seo.ogType === 'article' && (
  <>
    {seo.author && <meta property="article:author" content={seo.author} />}
    {seo.publishedTime && <meta property="article:published_time" content={seo.publishedTime} />}
    {seo.modifiedTime && <meta property="article:modified_time" content={seo.modifiedTime} />}
    {seo.section && <meta property="article:section" content={seo.section} />}
    {seo.tags && seo.tags.map(tag => <meta property="article:tag" content={tag} />)}
  </>
)}

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="icon" type="image/png" href="/favicon.png" />
<link rel="apple-touch-icon" href="/apple-touch-icon.png" />

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title={`${config.site.name} RSS Feed`} href="/rss.xml" />

<!-- Preconnect to external domains for performance -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
{config.monetization.adsense.enabled && (
  <link rel="preconnect" href="https://googleads.g.doubleclick.net" />
)}

<!-- JSON-LD structured data -->
{jsonLD && (
  <script type="application/ld+json" set:html={jsonLD} />
)}

<!-- Import global styles -->
<style>
  /* Critical CSS can be inlined here for better performance */
  html {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    scroll-behavior: smooth;
  }
</style>